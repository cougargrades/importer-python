# @cougargrades/importer
Pre-processes provided CSV files for usage in production databases

## Dependencies
- Python 3.6+
- Grade data:
    - in CSV format with the schema seen in `sample/sample.csv`
    - Real example data available at [cougargrades/FOIA-IR05921](https://github.com/cougargrades/FOIA-IR05921)

## Usage
- Install [pipenv](https://github.com/pypa/pipenv)
- `pipenv install`
- `pipenv shell`
- `$ ./csv2db.py foia/*.csv --out records.db`
- `$ ./db2firestore.py records.db --key firebaseadminsdk.json`

## Demo
[![asciicast](https://asciinema.org/a/sukllBJDXgcGfR5FK9TNuiGy8.svg)](https://asciinema.org/a/sukllBJDXgcGfR5FK9TNuiGy8)

## csv2db.py
```
usage: csv2db.py [-h] [--out OUTFILE] grades.csv [grades.csv ...]

Pre-process CSV grade data into a production-ready database format.

positional arguments:
  grades.csv     A set of CSV files to source data from

optional arguments:
  -h, --help     show this help message and exit
  --out OUTFILE  SQLite db file to create
```

## db2firestore.py
```
usage: db2firestore.py [-h] [--key KEY] [--offset OFFSET] [--limit LIMIT]
                       records.db

Import a SQLite database into Google Firestore

positional arguments:
  records.db       Path to the SQLite database generated by csv2db.py

optional arguments:
  -h, --help       show this help message and exit
  --key KEY        Path to Firebase Service account private key (see: README)
  --offset OFFSET  Number of SQLite entries to skip before writing them to
                   Firestore. Useful for preventing extra billing charges.
  --limit LIMIT    Maximum number of SQLite entries to write to Firestore,
                   quitting early if necessary. Useful for preventing extra
                   billing charges.
```

#### sqlite2maria.sh
Tweak for individual usage. Initially used to convert SQLite databases into compatible MariaDB ones.

Dependencies:
- sqlite 
- perl
